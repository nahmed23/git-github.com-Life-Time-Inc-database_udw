CREATE VIEW [marketing].[v_fact_spabiz_non_member_summary] AS select fact_spabiz_non_member_summary.dim_spabiz_customer_key dim_spabiz_customer_key,
       d_spabiz_customer.communicate_via_email_flag communicate_via_email_flag,
       d_spabiz_customer.email email,
       d_spabiz_customer.first_name first_name,
       d_spabiz_customer.gender_abbreviation gender_abbreviation,
       fact_spabiz_non_member_summary.latest_body_fact_spabiz_ticket_item_key latest_body_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_body_ticket_item_date_time latest_body_ticket_item_date_time,
       fact_spabiz_non_member_summary.latest_hair_fact_spabiz_ticket_item_key latest_hair_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_hair_ticket_item_date_time latest_hair_ticket_item_date_time,
       fact_spabiz_non_member_summary.latest_medi_fact_spabiz_ticket_item_key latest_medi_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_medi_ticket_item_date_time latest_medi_ticket_item_date_time,
       fact_spabiz_non_member_summary.latest_nail_fact_spabiz_ticket_item_key latest_nail_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_nail_ticket_item_date_time latest_nail_ticket_item_date_time,
       fact_spabiz_non_member_summary.latest_service_purchase_date_time latest_service_purchase_date_time,
       fact_spabiz_non_member_summary.latest_service_purchase_fact_spabiz_ticket_item_key latest_service_purchase_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_skin_fact_spabiz_ticket_item_key latest_skin_fact_spabiz_ticket_item_key,
       fact_spabiz_non_member_summary.latest_skin_ticket_item_date_time latest_skin_ticket_item_date_time,
       fact_spabiz_non_member_summary.next_appointment_date_time next_appointment_date_time,
       fact_spabiz_non_member_summary.next_appointment_fact_spabiz_appointment_item_key next_appointment_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.next_body_appointment_date_time next_body_appointment_date_time,
       fact_spabiz_non_member_summary.next_body_fact_spabiz_appointment_item_key next_body_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.next_hair_appointment_date_time next_hair_appointment_date_time,
       fact_spabiz_non_member_summary.next_hair_fact_spabiz_appointment_item_key next_hair_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.next_medi_appointment_date_time next_medi_appointment_date_time,
       fact_spabiz_non_member_summary.next_medi_fact_spabiz_appointment_item_key next_medi_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.next_nail_appointment_date_time next_nail_appointment_date_time,
       fact_spabiz_non_member_summary.next_nail_fact_spabiz_appointment_item_key next_nail_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.next_skin_appointment_date_time next_skin_appointment_date_time,
       fact_spabiz_non_member_summary.next_skin_fact_spabiz_appointment_item_key next_skin_fact_spabiz_appointment_item_key,
       fact_spabiz_non_member_summary.yearly_body_service_amount yearly_body_service_amount,
       fact_spabiz_non_member_summary.yearly_body_service_quantity yearly_body_service_quantity,
       fact_spabiz_non_member_summary.yearly_hair_service_amount yearly_hair_service_amount,
       fact_spabiz_non_member_summary.yearly_hair_service_quantity yearly_hair_service_quantity,
       fact_spabiz_non_member_summary.yearly_medi_service_amount yearly_medi_service_amount,
       fact_spabiz_non_member_summary.yearly_medi_service_quantity yearly_medi_service_quantity,
       fact_spabiz_non_member_summary.yearly_nail_service_amount yearly_nail_service_amount,
       fact_spabiz_non_member_summary.yearly_nail_service_quantity yearly_nail_service_quantity,
       fact_spabiz_non_member_summary.yearly_product_amount yearly_product_amount,
       fact_spabiz_non_member_summary.yearly_product_quantity yearly_product_quantity,
       fact_spabiz_non_member_summary.yearly_service_amount yearly_service_amount,
       fact_spabiz_non_member_summary.yearly_service_quantity yearly_service_quantity,
       fact_spabiz_non_member_summary.yearly_skin_service_amount yearly_skin_service_amount,
       fact_spabiz_non_member_summary.yearly_skin_service_quantity yearly_skin_service_quantity
  from fact_spabiz_non_member_summary
  join d_spabiz_customer
    on fact_spabiz_non_member_summary.dim_spabiz_customer_key = d_spabiz_customer.dim_spabiz_customer_key;