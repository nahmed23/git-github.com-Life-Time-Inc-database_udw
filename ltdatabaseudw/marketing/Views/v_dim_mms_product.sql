CREATE VIEW [marketing].[v_dim_mms_product]
AS select dim_mms_product.product_id product_id,
       dim_mms_product.access_by_price_paid_flag access_by_price_paid_flag,
       d_udwcloudsync_product_master.allocation_rule allocation_rule,
       dim_mms_product.assess_as_dues_flag assess_as_dues_flag,
       d_udwcloudsync_product_master.connectivity_lead_generator_flag connectivity_lead_generator_flag,
       d_udwcloudsync_product_master.connectivity_primary_lead_generator_flag connectivity_primary_lead_generator_flag,
       d_udwcloudsync_product_master.corporate_transfer_flag corporate_transfer_flag,
       d_udwcloudsync_product_master.corporate_transfer_multiplier corporate_transfer_multiplier,
       dim_mms_product.deferred_revenue_flag deferred_revenue_flag,
       dim_mms_product.department_description department_description,
       dim_mms_product.department_id department_id,
       d_udwcloudsync_product_master.departmental_dssr_flag departmental_dssr_flag,
       dim_mms_product.dim_mms_product_key dim_mms_product_key,
       isnull(d_udwcloudsync_product_master.dim_reporting_hierarchy_key,dim_mms_product.default_dim_reporting_hierarchy_key) dim_reporting_hierarchy_key,
       dim_mms_product.discount_gl_account discount_gl_account,
       dim_mms_product.display_ui_flag display_ui_flag,
       d_udwcloudsync_product_master.dssr_down_grade_other_enrollment_fee_flag dssr_down_grade_other_enrollment_fee_flag,
       d_udwcloudsync_product_master.dssr_if_admin_fee_flag dssr_if_admin_fee_flag,
       d_udwcloudsync_product_master.experience_life_magazine_flag experience_life_magazine_flag,
       dim_mms_product.gl_account_number gl_account_number,
       dim_mms_product.gl_department_code gl_department_code,
       dim_mms_product.gl_over_ride_club_id gl_over_ride_club_id,
       dim_mms_product.gl_product_code gl_product_code,
       dim_mms_product.junior_member_dues_flag junior_member_dues_flag,
       dim_mms_product.lt_buck_cost_percent lt_buck_cost_percent,
       dim_mms_product.lt_buck_eligible lt_buck_eligible,
       d_udwcloudsync_product_master.mtd_average_delivered_session_price_flag mtd_average_delivered_session_price_flag,
       d_udwcloudsync_product_master.mtd_average_sale_price_flag mtd_average_sale_price_flag,
       d_udwcloudsync_product_master.new_business_old_business_flag new_business_old_business_flag,
       dim_mms_product.package_product_flag package_product_flag,
       dim_mms_product.pay_component pay_component,
       d_udwcloudsync_product_master.payroll_description payroll_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_description payroll_lt_bucks_group_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_sort_order payroll_lt_bucks_group_sort_order,
       d_udwcloudsync_product_master.payroll_lt_bucks_product_group_flag payroll_lt_bucks_product_group_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_sales_amount_flag payroll_lt_bucks_sales_amount_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_service_amount_flag payroll_lt_bucks_service_amount_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_service_quantity_flag payroll_lt_bucks_service_quantity_flag,
       d_udwcloudsync_product_master.payroll_region_type payroll_region_type,
       d_udwcloudsync_product_master.payroll_standard_group_description payroll_standard_group_description,
       d_udwcloudsync_product_master.payroll_standard_group_sort_order payroll_standard_group_sort_order,
       d_udwcloudsync_product_master.payroll_standard_product_group_flag payroll_standard_product_group_flag,
       d_udwcloudsync_product_master.payroll_standard_sales_amount_flag payroll_standard_sales_amount_flag,
       d_udwcloudsync_product_master.payroll_standard_service_amount_flag payroll_standard_service_amount_flag,
       d_udwcloudsync_product_master.payroll_standard_service_quantity_flag payroll_standard_service_quantity_flag,
       d_udwcloudsync_product_master.payroll_track_sales_flag payroll_track_sales_flag,
       d_udwcloudsync_product_master.payroll_track_service_flag payroll_track_service_flag,
       dim_mms_product.price_locked_flag price_locked_flag,
       dim_mms_product.product_description product_description,
       dim_mms_product.product_name product_name,
       dim_mms_product.product_status product_status,
       dim_mms_product.recurrent_product_type_description recurrent_product_type_description,
       dim_mms_product.refund_gl_account_number refund_gl_account_number,
       isnull(d_udwcloudsync_product_master.reporting_department,'MMS') reporting_department,
       isnull(d_udwcloudsync_product_master.reporting_division,'MMS') reporting_division,
       isnull(d_udwcloudsync_product_master.reporting_product_group,'') reporting_product_group,
       d_udwcloudsync_product_master.reporting_product_group_gl_account reporting_product_group_gl_account,
       d_udwcloudsync_product_master.reporting_product_group_sort_order reporting_product_group_sort_order,
       d_udwcloudsync_product_master.reporting_region_type reporting_region_type,
       isnull(d_udwcloudsync_product_master.reporting_sub_division,'MMS') reporting_sub_division,
       dim_mms_product.revenue_category revenue_category,
       d_udwcloudsync_product_master.revenue_product_group_discount_gl_account revenue_product_group_discount_gl_account,
       d_udwcloudsync_product_master.revenue_product_group_refund_gl_account revenue_product_group_refund_gl_account,
       d_udwcloudsync_product_master.sales_category_description sales_category_description,
       dim_mms_product.sales_quantity_factor sales_quantity_factor,
       dim_mms_product.sku sku,
       dim_mms_product.spend_category spend_category,
       dim_mms_product.tip_allowed_flag tip_allowed_flag,
       dim_mms_product.workday_account workday_account,
       dim_mms_product.workday_cost_center workday_cost_center,
       dim_mms_product.workday_discount_gl_account workday_discount_gl_account,
       dim_mms_product.workday_offering workday_offering,
       dim_mms_product.workday_over_ride_region workday_over_ride_region,
       dim_mms_product.workday_refund_gl_account workday_refund_gl_account,
       dim_mms_product.workday_revenue_product_group_account workday_revenue_product_group_account,
       dim_mms_product.workday_revenue_product_group_discount_gl_account workday_revenue_product_group_discount_gl_account,
       dim_mms_product.workday_revenue_product_group_refund_gl_account workday_revenue_product_group_refund_gl_account
from dim_mms_product  left join d_udwcloudsync_product_master  on dim_mms_product.dim_mms_product_key = d_udwcloudsync_product_master.dim_mms_product_key and d_udwcloudsync_product_master.source_system = 'MMS';