CREATE VIEW [marketing].[v_fact_cafe_transaction_item]
AS select fact_cafe_sales_transaction_item.check_number check_number,
       fact_cafe_sales_transaction_item.check_seq check_seq,
       fact_cafe_sales_transaction_item.dim_cafe_discount_coupon_key dim_cafe_discount_coupon_key,
       fact_cafe_sales_transaction_item.dim_cafe_product_key dim_cafe_product_key,
       fact_cafe_sales_transaction_item.dim_cafe_profit_center_key dim_cafe_profit_center_key,
       fact_cafe_sales_transaction_item.dim_club_key dim_club_key,
       fact_cafe_sales_transaction_item.dim_mms_member_key dim_mms_member_key,
       fact_cafe_sales_transaction_item.fact_cafe_sales_transaction_item_key fact_cafe_sales_transaction_item_key,
       fact_cafe_sales_transaction_item.item_discount_amount item_discount_amount,
       fact_cafe_sales_transaction_item.item_quantity item_quantity,
       fact_cafe_sales_transaction_item.item_refund_flag item_refund_flag,
       fact_cafe_sales_transaction_item.item_sales_amount_gross item_sales_amount_gross,
       fact_cafe_sales_transaction_item.item_sales_dollar_amount_excluding_tax item_sales_dollar_amount_excluding_tax,
       fact_cafe_sales_transaction_item.item_tax_amount item_tax_amount,
       fact_cafe_sales_transaction_item.item_voided_flag item_voided_flag,
       fact_cafe_sales_transaction_item.order_close_dim_date_key order_close_dim_date_key,
       fact_cafe_sales_transaction_item.order_close_dim_time_key order_close_dim_time_key,
       fact_cafe_sales_transaction_item.order_close_month_ending_dim_date_key order_close_month_ending_dim_date_key,
       fact_cafe_sales_transaction_item.order_closed_flag order_closed_flag,
       fact_cafe_sales_transaction_item.order_commissionable_dim_employee_key order_commissionable_dim_employee_key,
       fact_cafe_sales_transaction_item.order_discount_amount order_discount_amount,
       fact_cafe_sales_transaction_item.order_hdr_id order_hdr_id,
       fact_cafe_sales_transaction_item.order_open_dim_date_key order_open_dim_date_key,
       fact_cafe_sales_transaction_item.order_open_dim_time_key order_open_dim_time_key,
       fact_cafe_sales_transaction_item.order_refund_flag order_refund_flag,
       fact_cafe_sales_transaction_item.order_sales_amount_gross order_sales_amount_gross,
       fact_cafe_sales_transaction_item.order_service_charge_amount order_service_charge_amount,
       fact_cafe_sales_transaction_item.order_tax_amount order_tax_amount,
       fact_cafe_sales_transaction_item.order_tax_removed_flag order_tax_removed_flag,
       fact_cafe_sales_transaction_item.order_tip_amount order_tip_amount,
       fact_cafe_sales_transaction_item.order_void_flag order_void_flag,
       fact_cafe_sales_transaction_item.original_currency_code original_currency_code,
       fact_cafe_sales_transaction_item.posted_business_end_dim_date_key posted_business_end_dim_date_key,
       fact_cafe_sales_transaction_item.posted_business_start_dim_date_key posted_business_start_dim_date_key,
       case when fact_cafe_sales_transaction_item.order_refund_flag = 'Y' or fact_cafe_sales_transaction_item.item_refund_flag = 'Y' then 'Y' else 'N' end refund_flag,
       fact_cafe_sales_transaction_item.udw_inserted_dim_date_key udw_inserted_dim_date_key,
       fact_cafe_sales_transaction_item.usd_dim_plan_exchange_rate usd_dim_plan_exchange_rate,
       fact_cafe_sales_transaction_item.usd_monthly_average_dim_exchange_rate_key usd_monthly_average_dim_exchange_rate_key
  from dbo.fact_cafe_sales_transaction_item;