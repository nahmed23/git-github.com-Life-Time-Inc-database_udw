CREATE VIEW [marketing].[v_dim_hybris_product]
AS select d_hybris_all_products.accept_lt_bucks_flag accept_lt_bucks_flag,
       d_hybris_all_products.active_catalog_version active_catalog_version,
       d_udwcloudsync_product_master.allocation_rule allocation_rule,
       d_hybris_all_products.auto_ship_flag auto_ship_flag,
       d_hybris_all_products.caption caption,
       d_hybris_all_products.catalog_name catalog_name,
       d_hybris_all_products.catalog_version catalog_version,
       d_hybris_all_products.catalog_version_name catalog_version_name,
       d_hybris_all_products.code code,
       d_udwcloudsync_product_master.connectivity_lead_generator_flag connectivity_lead_generator_flag,
       d_udwcloudsync_product_master.connectivity_primary_lead_generator_flag connectivity_primary_lead_generator_flag,
       d_udwcloudsync_product_master.corporate_transfer_flag corporate_transfer_flag,
       d_udwcloudsync_product_master.corporate_transfer_multiplier corporate_transfer_multiplier,
       d_hybris_all_products.created_ts created_ts,
       d_hybris_all_products.creation_time creation_time,
       d_udwcloudsync_product_master.departmental_dssr_flag departmental_dssr_flag,
       d_hybris_all_products.description description,
       d_hybris_all_products.dim_hybris_product_key dim_hybris_product_key,
       isnull(d_udwcloudsync_product_master.dim_reporting_hierarchy_key,d_hybris_all_products.default_dim_reporting_hierarchy_key) dim_reporting_hierarchy_key,
       d_hybris_all_products.e_gift_card_flag e_gift_card_flag,
       d_hybris_all_products.ean ean,
       d_hybris_all_products.electronic_shipping_flag electronic_shipping_flag,
       d_hybris_all_products.fulfillment_partner fulfillment_partner,
       d_hybris_all_products.lt_bucks_earned lt_bucks_earned,
       d_hybris_all_products.ltf_offer_flag ltf_offer_flag,
       d_hybris_all_products.ltf_only_product ltf_only_product,
       d_hybris_all_products.modified_time modified_time,
       d_udwcloudsync_product_master.mtd_average_delivered_session_price_flag mtd_average_delivered_session_price_flag,
       d_udwcloudsync_product_master.mtd_average_sale_price_flag mtd_average_sale_price_flag,
       d_hybris_all_products.name name,
       d_udwcloudsync_product_master.new_business_old_business_flag new_business_old_business_flag,
       d_hybris_all_products.offer_external_link_flag offer_external_link_flag,
       d_hybris_all_products.offer_link offer_link,
       d_hybris_all_products.offline_datetime offline_datetime,
       d_hybris_all_products.online_datetime online_datetime,
       d_udwcloudsync_product_master.payroll_description payroll_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_description payroll_lt_bucks_group_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_sort_order payroll_lt_bucks_group_sort_order,
       isnull(d_udwcloudsync_product_master.payroll_lt_bucks_product_group_flag,'N') payroll_lt_bucks_product_group_flag,
       isnull(d_udwcloudsync_product_master.payroll_lt_bucks_sales_amount_flag,'N') payroll_lt_bucks_sales_amount_flag,
       isnull(d_udwcloudsync_product_master.payroll_lt_bucks_service_amount_flag,'N') payroll_lt_bucks_service_amount_flag,
       isnull(d_udwcloudsync_product_master.payroll_lt_bucks_service_quantity_flag,'N') payroll_lt_bucks_service_quantity_flag,
       d_udwcloudsync_product_master.payroll_region_type payroll_region_type,
       d_udwcloudsync_product_master.payroll_standard_group_description payroll_standard_group_description,
       d_udwcloudsync_product_master.payroll_standard_group_sort_order payroll_standard_group_sort_order,
       isnull(d_udwcloudsync_product_master.payroll_standard_product_group_flag,'N') payroll_standard_product_group_flag,
       isnull(d_udwcloudsync_product_master.payroll_standard_sales_amount_flag,'N') payroll_standard_sales_amount_flag,
       isnull(d_udwcloudsync_product_master.payroll_standard_service_amount_flag,'N') payroll_standard_service_amount_flag,
       isnull(d_udwcloudsync_product_master.payroll_standard_service_quantity_flag,'N') payroll_standard_service_quantity_flag,
       isnull(d_udwcloudsync_product_master.payroll_track_sales_flag,'N') payroll_track_sales_flag,
       isnull(d_udwcloudsync_product_master.payroll_track_service_flag,'N') payroll_track_service_flag,
       d_hybris_all_products.product_category product_category,
       d_hybris_all_products.product_cost product_cost,
       d_hybris_all_products.product_height product_height,
       d_hybris_all_products.product_length product_length,
       d_udwcloudsync_product_master.product_status product_status,
       d_hybris_all_products.product_stock_level product_stock_level,
       d_hybris_all_products.product_stock_status product_stock_status,
       d_hybris_all_products.product_sub_category product_sub_category,
       d_hybris_all_products.product_type product_type,
       d_hybris_all_products.product_width product_width,
       isnull(d_udwcloudsync_product_master.reporting_department,'E-Commerce') reporting_department,
       isnull(d_udwcloudsync_product_master.reporting_division,'E-Commerce') reporting_division,
       isnull(d_udwcloudsync_product_master.reporting_product_group,'') reporting_product_group,
       d_udwcloudsync_product_master.reporting_product_group_gl_account reporting_product_group_gl_account,
       d_udwcloudsync_product_master.reporting_product_group_sort_order reporting_product_group_sort_order,
       d_udwcloudsync_product_master.reporting_region_type reporting_region_type,
       isnull(d_udwcloudsync_product_master.reporting_sub_division,'E-Commerce') reporting_sub_division,
       d_udwcloudsync_product_master.sales_category_description sales_category_description,
       d_hybris_all_products.summary summary,
       d_hybris_all_products.weight weight
from d_hybris_all_products  left join d_udwcloudsync_product_master  on d_hybris_all_products.dim_hybris_product_key = d_udwcloudsync_product_master.dim_hybris_product_key and d_udwcloudsync_product_master.source_system = 'E-Commerce - Hybris';