CREATE VIEW [marketing].[v_dim_athlinks_api_vw_race_entry]
AS select d_athlinks_api_vw_race_entry.entry_id entry_id,
       d_athlinks_api_vw_race_entry.age age,
       d_athlinks_api_vw_race_entry.bib_num bib_num,
       d_athlinks_api_vw_race_entry.city city,
       d_athlinks_api_vw_race_entry.class_id class_id,
       d_athlinks_api_vw_race_entry.class_name class_name,
       d_athlinks_api_vw_race_entry.course_id course_id,
       d_athlinks_api_vw_race_entry.create_date create_date,
       d_athlinks_api_vw_race_entry.create_dim_date_key create_dim_date_key,
       d_athlinks_api_vw_race_entry.create_dim_time_key create_dim_time_key,
       d_athlinks_api_vw_race_entry.d_athlinks_api_vw_athlete_non_member_bk_hash d_athlinks_api_vw_athlete_non_member_bk_hash,
       d_athlinks_api_vw_race_entry.d_athlinks_api_vw_course_bk_hash d_athlinks_api_vw_course_bk_hash,
       d_athlinks_api_vw_race_entry.d_athlinks_api_vw_master_event_bk_hash d_athlinks_api_vw_master_event_bk_hash,
       d_athlinks_api_vw_race_entry.d_athlinks_api_vw_race_ltf_data_bk_hash d_athlinks_api_vw_race_ltf_data_bk_hash,
       d_athlinks_api_vw_race_entry.display_name display_name,
       d_athlinks_api_vw_race_entry.entry_state_prov_id entry_state_prov_id,
       d_athlinks_api_vw_race_entry.event_course_id event_course_id,
       d_athlinks_api_vw_race_entry.event_d_athlinks_api_vw_course_bk_hash event_d_athlinks_api_vw_course_bk_hash,
       d_athlinks_api_vw_race_entry.gender gender,
       d_athlinks_api_vw_race_entry.is_member_flag is_member_flag,
       d_athlinks_api_vw_race_entry.master_id master_id,
       d_athlinks_api_vw_race_entry.master_name master_name,
       d_athlinks_api_vw_race_entry.photo_path photo_path,
       d_athlinks_api_vw_race_entry.race_date race_date,
       d_athlinks_api_vw_race_entry.race_dim_date_key race_dim_date_key,
       d_athlinks_api_vw_race_entry.race_dim_time_key race_dim_time_key,
       d_athlinks_api_vw_race_entry.race_id race_id,
       d_athlinks_api_vw_race_entry.racer_id racer_id,
       d_athlinks_api_vw_race_entry.rank_a rank_a,
       d_athlinks_api_vw_race_entry.rank_g rank_g,
       d_athlinks_api_vw_race_entry.rank_o rank_o,
       d_athlinks_api_vw_race_entry.result_count result_count,
       d_athlinks_api_vw_race_entry.results_date results_date,
       d_athlinks_api_vw_race_entry.results_dim_date_key results_dim_date_key,
       d_athlinks_api_vw_race_entry.results_dim_time_key results_dim_time_key,
       d_athlinks_api_vw_race_entry.ticks ticks,
       d_athlinks_api_vw_race_entry.ticks_string ticks_string,
       d_athlinks_api_vw_race_entry.total_a total_a,
       d_athlinks_api_vw_race_entry.total_g total_g,
       d_athlinks_api_vw_race_entry.total_o total_o
from d_athlinks_api_vw_race_entry where LEFT(entry_state_prov_id,3) = 'US_' OR LEFT(entry_state_prov_id,3) = 'CA_';