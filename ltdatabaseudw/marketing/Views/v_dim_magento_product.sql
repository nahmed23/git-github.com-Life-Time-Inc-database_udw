CREATE VIEW [marketing].[v_dim_magento_product]
AS select dim_magento_product.color color,
       d_udwcloudsync_product_master.connectivity_lead_generator_flag connectivity_lead_generator_flag,
       d_udwcloudsync_product_master.connectivity_primary_lead_generator_flag connectivity_primary_lead_generator_flag,
       dim_magento_product.created_dim_date_key created_dim_date_key,
       dim_magento_product.created_dim_time_key created_dim_time_key,
       dim_magento_product.default_dim_reporting_hierarchy_key default_dim_reporting_hierarchy_key,
       d_udwcloudsync_product_master.departmental_dssr_flag departmental_dssr_flag,
       dim_magento_product.description description,
       dim_magento_product.dim_club_key dim_club_key,
       dim_magento_product.dim_magento_product_key dim_magento_product_key,
       dim_magento_product.dim_mms_product_key dim_mms_product_key,
       isnull(d_udwcloudsync_product_master.dim_reporting_hierarchy_key,dim_magento_product.default_dim_reporting_hierarchy_key) dim_reporting_hierarchy_key,
       dim_magento_product.free_shipping free_shipping,
       dim_magento_product.has_options_flag has_options_flag,
       dim_magento_product.height height,
       dim_magento_product.length length,
       dim_magento_product.lt_bucks_eligible lt_bucks_eligible,
       d_udwcloudsync_product_master.new_business_old_business_flag new_business_old_business_flag,
       d_udwcloudsync_product_master.payroll_description payroll_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_description payroll_lt_bucks_group_description,
       d_udwcloudsync_product_master.payroll_lt_bucks_group_sort_order payroll_lt_bucks_group_sort_order,
       d_udwcloudsync_product_master.payroll_lt_bucks_product_group_flag payroll_lt_bucks_product_group_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_sales_amount_flag payroll_lt_bucks_sales_amount_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_service_amount_flag payroll_lt_bucks_service_amount_flag,
       d_udwcloudsync_product_master.payroll_lt_bucks_service_quantity_flag payroll_lt_bucks_service_quantity_flag,
       d_udwcloudsync_product_master.payroll_region_type payroll_region_type,
       d_udwcloudsync_product_master.payroll_standard_group_description payroll_standard_group_description,
       d_udwcloudsync_product_master.payroll_standard_group_sort_order payroll_standard_group_sort_order,
       d_udwcloudsync_product_master.payroll_standard_product_group_flag payroll_standard_product_group_flag,
       d_udwcloudsync_product_master.payroll_standard_sales_amount_flag payroll_standard_sales_amount_flag,
       d_udwcloudsync_product_master.payroll_standard_service_amount_flag payroll_standard_service_amount_flag,
       d_udwcloudsync_product_master.payroll_standard_service_quantity_flag payroll_standard_service_quantity_flag,
       d_udwcloudsync_product_master.payroll_track_sales_flag payroll_track_sales_flag,
       d_udwcloudsync_product_master.payroll_track_service_flag payroll_track_service_flag,
       dim_magento_product.product_id product_id,
       dim_magento_product.product_name product_name,
       isnull(d_udwcloudsync_product_master.reporting_department,'Magento') reporting_department,
       isnull(d_udwcloudsync_product_master.reporting_division,'Magento') reporting_division,
       isnull(d_udwcloudsync_product_master.reporting_product_group,'') reporting_product_group,
       d_udwcloudsync_product_master.reporting_product_group_sort_order reporting_product_group_sort_order,
       d_udwcloudsync_product_master.reporting_region_type reporting_region_type,
       isnull(d_udwcloudsync_product_master.reporting_sub_division,'Magento') reporting_sub_division,
       dim_magento_product.required_options_flag required_options_flag,
       dim_magento_product.short_description short_description,
       dim_magento_product.sku sku,
       dim_magento_product.status status,
       dim_magento_product.type_id type_id,
       dim_magento_product.updated_dim_date_key updated_dim_date_key,
       dim_magento_product.updated_dim_time_key updated_dim_time_key,
       dim_magento_product.vendor vendor,
       dim_magento_product.weight weight,
       dim_magento_product.width width,
       dim_magento_product.workday_costcenter_id workday_costcenter_id,
       dim_magento_product.workday_offering_id workday_offering_id,
       dim_magento_product.workday_region_id workday_region_id,
       dim_magento_product.workday_revenue_id workday_revenue_id,
       dim_magento_product.workday_spending_id workday_spending_id
from dim_magento_product  left join d_udwcloudsync_product_master
on dim_magento_product.dim_magento_product_key = d_udwcloudsync_product_master.dim_magento_product_key
and d_udwcloudsync_product_master.source_system = 'Magento';